import Image from "next/image";
import Link from "next/link";

import { useEffect } from "react";
import { useSession, signIn, signOut } from "next-auth/react";
import { useRouter } from "next/router";
import { useState } from "react";

const Navbar = ({ setIsloggedin, isloggedin,inmain }) => {
  const [searchTerm, setSearchTerm] = useState("")
  const { session, data, status } = useSession();
  useEffect(() => {
    if (status === "authenticated") {
      setIsloggedin(true);
    }
  }, [status]);
  const router= useRouter()
  const handleSearch = (e) => {
    e.preventDefault();

    // Redirect to the search results page with the search query as a query parameter
    router.push(`/search?query=${encodeURIComponent(searchTerm)}`);

    // Clear the search term
    setSearchTerm('');
  };
  return (
    <nav id="navbar" className="bg-white">
      <div className="w-full top-0 bg-white fixed z-50 px-4 sm:px-6 lg:px-8">
        <div className="flex p-4 items-center justify-between ">
          {/* Logo/Brand */}
          <div className="flex-shrink-0 scale flex flex-row justify-center items-center">
            <Image height={30} width={30} src="/logo.png" alt="Logo" />
            <Link href={"/"}>

            <h1 className="ml-3 text-xl poppins ">EcoBliss</h1>
            </Link>

            <div className="hidden ml-10 md:block ">
              <div className="ml-10 text-md flex items-baseline space-x-4">
              <button className="button px-7 scale rounded-full shadow h-12">
                    <Link
                      href="/shop"
                      className="text-[#646464] hover:text-[#086828dd]  rounded-md  font-medium"
                    >
                      <div className="flex flex-row">
                        <svg
                          className="hover:text-[#086828dd]"
                          width="14"
                          height="18"
                          viewBox="0 0 14 18"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            d="M14 4.5V15.75C14 16.0605 13.9439 16.3506 13.8317 16.6201C13.7196 16.8896 13.5653 17.127 13.369 17.332C13.1727 17.5371 12.9427 17.6982 12.6791 17.8154C12.4155 17.9326 12.1378 17.9941 11.8462 18H2.15385C1.85657 18 1.57893 17.9414 1.32091 17.8242C1.0629 17.707 0.835737 17.5459 0.639423 17.3408C0.443109 17.1357 0.288862 16.8984 0.176683 16.6289C0.0645032 16.3594 0.00560897 16.0664 0 15.75V4.5H2.15385V3.375C2.15385 2.91211 2.23798 2.47559 2.40625 2.06543C2.57452 1.65527 2.80729 1.29785 3.10457 0.993164C3.40184 0.688477 3.74399 0.448242 4.13101 0.272461C4.51803 0.0966797 4.9359 0.00585938 5.38462 0C5.96795 0 6.50921 0.152344 7.00841 0.457031C7.50761 0.152344 8.04327 0 8.61539 0C9.05849 0 9.47636 0.0878906 9.86899 0.263672C10.2616 0.439453 10.6038 0.682617 10.8954 0.993164C11.1871 1.30371 11.4171 1.66113 11.5853 2.06543C11.7536 2.46973 11.8405 2.90625 11.8462 3.375V4.5H14ZM10.7692 3.375C10.7692 3.07031 10.7131 2.78027 10.601 2.50488C10.4888 2.22949 10.3345 1.99219 10.1382 1.79297C9.94191 1.59375 9.71194 1.43262 9.44832 1.30957C9.1847 1.18652 8.90705 1.125 8.61539 1.125C8.36298 1.125 8.1246 1.16895 7.90024 1.25684C8.0629 1.46777 8.19191 1.67578 8.28726 1.88086C8.38261 2.08594 8.45272 2.29102 8.4976 2.49609C8.54247 2.70117 8.57332 2.90918 8.59015 3.12012C8.60697 3.33105 8.61539 3.55664 8.61539 3.79688V4.5H10.7692V3.375ZM3.23077 4.5H7.53846V3.375C7.53846 3.07031 7.48237 2.78027 7.37019 2.50488C7.25801 2.22949 7.10377 1.99219 6.90745 1.79297C6.71114 1.59375 6.48117 1.43262 6.21755 1.30957C5.95393 1.18652 5.67628 1.125 5.38462 1.125C5.08734 1.125 4.8097 1.18359 4.55168 1.30078C4.29367 1.41797 4.06651 1.5791 3.87019 1.78418C3.67388 1.98926 3.51963 2.22949 3.40745 2.50488C3.29527 2.78027 3.23638 3.07031 3.23077 3.375V4.5ZM9.97837 16.875C9.78766 16.5234 9.69231 16.1484 9.69231 15.75V5.625H1.07692V15.75C1.07692 15.9082 1.10497 16.0547 1.16106 16.1895C1.21715 16.3242 1.29287 16.4414 1.38822 16.541C1.48357 16.6406 1.59856 16.7227 1.73317 16.7871C1.86779 16.8516 2.00801 16.8809 2.15385 16.875H9.97837ZM12.9231 5.625H10.7692V15.75C10.7692 15.9082 10.7973 16.0547 10.8534 16.1895C10.9095 16.3242 10.9852 16.4414 11.0805 16.541C11.1759 16.6406 11.2909 16.7227 11.4255 16.7871C11.5601 16.8516 11.7003 16.8809 11.8462 16.875C11.9976 16.875 12.1378 16.8457 12.2668 16.7871C12.3958 16.7285 12.508 16.6494 12.6034 16.5498C12.6987 16.4502 12.7772 16.3301 12.8389 16.1895C12.9006 16.0488 12.9287 15.9023 12.9231 15.75V5.625Z"
                            fill="#646464" />
                        </svg>
                        <h2 className="ml-3">Shop</h2>
                      </div>
                    </Link>
                  </button><button className="px-7 button scale rounded-full shadow h-12">
                      <Link
                        href="/social"
                        className="text-[#646464] hover:text-[#086828dd] rounded-md  font-medium"
                      >
                        <div className="flex flex-row">
                          <svg
                            className="hover:text-[#086828dd]"
                            width="23"
                            height="17"
                            viewBox="0 0 23 17"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                          >
                            <path
                              d="M9.00387 13.6257C8.85689 13.589 8.7305 13.4954 8.65249 13.3656C8.57448 13.2357 8.55124 13.0802 8.58787 12.9332L8.98216 11.3572H7.42787C7.27632 11.3572 7.13098 11.297 7.02381 11.1898C6.91665 11.0826 6.85645 10.9373 6.85645 10.7857C6.85645 10.6342 6.91665 10.4888 7.02381 10.3817C7.13098 10.2745 7.27632 10.2143 7.42787 10.2143H9.26787L9.73073 8.36173C9.74787 8.28783 9.77955 8.21807 9.82393 8.15654C9.8683 8.09501 9.92449 8.04293 9.98921 8.00334C10.0539 7.96375 10.1259 7.93745 10.2009 7.92596C10.2759 7.91447 10.3524 7.91803 10.426 7.93643C10.4996 7.95483 10.5688 7.98771 10.6295 8.03313C10.6903 8.07856 10.7414 8.13563 10.7799 8.20101C10.8184 8.2664 10.8434 8.33879 10.8536 8.41397C10.8638 8.48914 10.859 8.5656 10.8393 8.63887L10.445 10.2143H11.9993C12.1509 10.2143 12.2962 10.2745 12.4034 10.3817C12.5105 10.4888 12.5707 10.6342 12.5707 10.7857C12.5707 10.9373 12.5105 11.0826 12.4034 11.1898C12.2962 11.297 12.1509 11.3572 11.9993 11.3572H10.1593L9.69644 13.2103C9.65961 13.3572 9.56598 13.4834 9.43612 13.5613C9.30626 13.6392 9.1508 13.6624 9.00387 13.6257Z"
                              fill="#646464" />
                            <path
                              fill-rule="evenodd"
                              clip-rule="evenodd"
                              d="M2.86489 6.29314C3.0866 5.568 3.76546 5.07143 4.53575 5.07143H18.2855V3.92857H14.2855V0.5H19.4283V5.62114L22.8197 13.4423C22.8472 13.5151 22.8594 13.5928 22.8556 13.6705C22.8518 13.7482 22.8321 13.8243 22.7977 13.8941C22.7633 13.9639 22.715 14.0259 22.6557 14.0763C22.5964 14.1266 22.5273 14.1643 22.4529 14.1869L22.4535 14.1891L16.8569 15.9286L17.4283 14.5L21.4809 13.2874L18.8483 7.43029L16.1037 15.2783C15.8826 16.0034 15.2037 16.5 14.434 16.5H1.74489C0.57689 16.5 -0.260824 15.3931 0.0746047 14.2931L2.86489 6.29314ZM1.16318 14.6423L3.95175 6.648L3.95803 6.62686C3.99767 6.50542 4.07513 6.39986 4.17909 6.32563C4.28304 6.25139 4.40802 6.21237 4.53575 6.21429H18.0632L15.0175 14.9229L15.0112 14.9446C14.9715 15.066 14.8941 15.1716 14.7901 15.2458C14.6862 15.32 14.5612 15.3591 14.4335 15.3571H1.74489C1.32375 15.3571 1.07175 14.9777 1.16318 14.6423ZM18.2855 1.64286H15.4283V2.78571H18.2855V1.64286Z"
                              fill="#646464" />
                          </svg>

                          <h2 className="ml-3">Social</h2>
                        </div>
                      </Link>
                    </button><button className="button px-7 scale rounded-full shadow h-12">
                      <Link
                        href="/recycle"
                        className="text-[#646464] hover:text-[#086828dd] rounded-md  font-medium"
                      >
                        <div className="flex flex-row">
                          <svg
                            className="hover:text-[#086828dd]"
                            width="16"
                            height="16"
                            viewBox="0 0 16 16"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                          >
                            <path
                              d="M5.45832 1.43166C6.00509 0.539651 6.9674 0 7.99844 0C9.02948 0 9.99179 0.539651 10.5386 1.43166L11.7446 3.39028L12.5881 2.89507C12.8506 2.73952 13.1786 2.76174 13.4192 2.94903C13.6598 3.13632 13.766 3.45376 13.6879 3.75216L12.9568 6.5266C12.8506 6.93293 12.4382 7.17418 12.0382 7.06625L9.30755 6.32344C9.01386 6.24408 8.79828 5.9933 8.75766 5.68855C8.71704 5.38381 8.86389 5.08224 9.12634 4.92987L10.0137 4.40926L8.84202 2.50779C8.6608 2.21257 8.34212 2.03163 7.99844 2.03163C7.65476 2.03163 7.33607 2.21257 7.15486 2.50779L6.60809 3.39663C6.32065 3.86644 5.71452 4.01564 5.24587 3.72994C4.76784 3.43789 4.61474 2.80301 4.91156 2.3205L5.45832 1.43166ZM13.4192 7.99635C13.8879 7.71066 14.494 7.85985 14.7814 8.32967L15.5438 9.57087C15.8375 10.0502 15.9937 10.5994 16 11.1644C16.0093 12.85 14.6658 14.2246 13.0068 14.2246L9.99804 14.2214V15.2372C9.99804 15.5451 9.81682 15.8245 9.53563 15.9419C9.25444 16.0594 8.93262 15.9959 8.71704 15.7768L6.71745 13.7452C6.42376 13.4468 6.42376 12.9643 6.71745 12.6691L8.71704 10.6375C8.93262 10.4184 9.25444 10.3549 9.53563 10.4724C9.81682 10.5899 9.99804 10.8692 9.99804 11.1771V12.1929H13.0037C13.5536 12.1929 14.0004 11.7358 13.9972 11.1771C13.9972 10.9898 13.9441 10.8057 13.8473 10.647L13.0849 9.4058C12.7881 8.92328 12.9381 8.2884 13.4192 7.99635ZM2.02777 7.01229L1.12482 6.48216C0.862375 6.32661 0.71553 6.02822 0.756147 5.72347C0.796763 5.41873 1.01234 5.16795 1.30604 5.08859L4.03674 4.34578C4.43666 4.23785 4.84907 4.4791 4.9553 4.88543L5.6864 7.65669C5.76451 7.95509 5.65828 8.26935 5.41771 8.45982C5.17713 8.65028 4.84907 8.66933 4.58663 8.51379L3.75867 8.0281L2.14962 10.6438C2.05276 10.8025 1.99965 10.9867 1.99965 11.1739C1.99652 11.7326 2.44331 12.1898 2.9932 12.1898H3.99924C4.55226 12.1898 4.99904 12.6437 4.99904 13.2056C4.99904 13.7674 4.55226 14.2214 3.99924 14.2214H2.9932C1.33416 14.2214 -0.00932436 12.85 4.87488e-05 11.1612C0.00317312 10.5962 0.159392 10.047 0.456207 9.56769L2.02777 7.01229Z"
                              fill="#646464" />
                          </svg>

                          <h2 className="ml-3">Recycle</h2>
                        </div>
                      </Link>
                    </button>
              {inmain==false? 
                <></>
              :
              <form className="flex gap-x-4" onSubmit={handleSearch}>
      <input className="py-2 rounded-full px-8"
        type="text"
        placeholder="Search products..."
        value={searchTerm}
        onChange={(e) => setSearchTerm(e.target.value)}
      />
       <button type="submit" className="button  text-white bg-[#444444] font-semibold py-[10px] w-[9vw] rounded-full border-[#444444] border">
        Search
      </button> 
    </form>
    
              }
              </div>
            </div>
          </div>

          {/* Links */}

          {/* Buttons */}
          <div className="hidden md:block">
            <div className="ml-4 space-x-6 flex items-center md:ml-6">
            {
              inmain? <svg className="cursor-pointer" onClick={()=> router.push("/cart")} width="64" height="27" viewBox="0 0 64 27" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M24.8027 13.718C24.8027 12.494 25.0847 11.396 25.6487 10.424C26.2247 9.452 26.9987 8.696 27.9707 8.156C28.9547 7.604 30.0287 7.328 31.1927 7.328C32.5247 7.328 33.7067 7.658 34.7387 8.318C35.7827 8.966 36.5387 9.89 37.0067 11.09H34.5407C34.2167 10.43 33.7667 9.938 33.1907 9.614C32.6147 9.29 31.9487 9.128 31.1927 9.128C30.3647 9.128 29.6267 9.314 28.9787 9.686C28.3307 10.058 27.8207 10.592 27.4487 11.288C27.0887 11.984 26.9087 12.794 26.9087 13.718C26.9087 14.642 27.0887 15.452 27.4487 16.148C27.8207 16.844 28.3307 17.384 28.9787 17.768C29.6267 18.14 30.3647 18.326 31.1927 18.326C31.9487 18.326 32.6147 18.164 33.1907 17.84C33.7667 17.516 34.2167 17.024 34.5407 16.364H37.0067C36.5387 17.564 35.7827 18.488 34.7387 19.136C33.7067 19.784 32.5247 20.108 31.1927 20.108C30.0167 20.108 28.9427 19.838 27.9707 19.298C26.9987 18.746 26.2247 17.984 25.6487 17.012C25.0847 16.04 24.8027 14.942 24.8027 13.718ZM38.7246 14.996C38.7246 14 38.9286 13.118 39.3366 12.35C39.7566 11.582 40.3206 10.988 41.0286 10.568C41.7486 10.136 42.5406 9.92 43.4046 9.92C44.1846 9.92 44.8626 10.076 45.4386 10.388C46.0266 10.688 46.4946 11.066 46.8426 11.522V10.082H48.9126V20H46.8426V18.524C46.4946 18.992 46.0206 19.382 45.4206 19.694C44.8206 20.006 44.1366 20.162 43.3686 20.162C42.5166 20.162 41.7366 19.946 41.0286 19.514C40.3206 19.07 39.7566 18.458 39.3366 17.678C38.9286 16.886 38.7246 15.992 38.7246 14.996ZM46.8426 15.032C46.8426 14.348 46.6986 13.754 46.4106 13.25C46.1346 12.746 45.7686 12.362 45.3126 12.098C44.8566 11.834 44.3646 11.702 43.8366 11.702C43.3086 11.702 42.8166 11.834 42.3606 12.098C41.9046 12.35 41.5326 12.728 41.2446 13.232C40.9686 13.724 40.8306 14.312 40.8306 14.996C40.8306 15.68 40.9686 16.28 41.2446 16.796C41.5326 17.312 41.9046 17.708 42.3606 17.984C42.8286 18.248 43.3206 18.38 43.8366 18.38C44.3646 18.38 44.8566 18.248 45.3126 17.984C45.7686 17.72 46.1346 17.336 46.4106 16.832C46.6986 16.316 46.8426 15.716 46.8426 15.032ZM53.6598 11.522C53.9598 11.018 54.3558 10.628 54.8478 10.352C55.3518 10.064 55.9458 9.92 56.6298 9.92V12.044H56.1078C55.3038 12.044 54.6918 12.248 54.2718 12.656C53.8638 13.064 53.6598 13.772 53.6598 14.78V20H51.6078V10.082H53.6598V11.522ZM60.91 11.756V17.246C60.91 17.618 60.994 17.888 61.162 18.056C61.342 18.212 61.642 18.29 62.062 18.29H63.322V20H61.702C60.778 20 60.07 19.784 59.578 19.352C59.086 18.92 58.84 18.218 58.84 17.246V11.756H57.67V10.082H58.84V7.616H60.91V10.082H63.322V11.756H60.91Z" fill="#646464"/>
<path d="M16 20.2C16.5304 20.2 17.0391 20.4002 17.4142 20.7565C17.7893 21.1128 18 21.5961 18 22.1C18 22.6039 17.7893 23.0872 17.4142 23.4435C17.0391 23.7998 16.5304 24 16 24C15.4696 24 14.9609 23.7998 14.5858 23.4435C14.2107 23.0872 14 22.6039 14 22.1C14 21.0455 14.89 20.2 16 20.2ZM0 5H3.27L4.21 6.9H19C19.2652 6.9 19.5196 7.00009 19.7071 7.17825C19.8946 7.35641 20 7.59804 20 7.85C20 8.0115 19.95 8.173 19.88 8.325L16.3 14.4715C15.96 15.051 15.3 15.45 14.55 15.45H7.1L6.2 16.9985L6.17 17.1125C6.17 17.1755 6.19634 17.2359 6.24322 17.2804C6.29011 17.325 6.3537 17.35 6.42 17.35H18V19.25H6C5.46957 19.25 4.96086 19.0498 4.58579 18.6935C4.21071 18.3372 4 17.8539 4 17.35C4 17.0175 4.09 16.704 4.24 16.438L5.6 14.1105L2 6.9H0V5ZM6 20.2C6.53043 20.2 7.03914 20.4002 7.41421 20.7565C7.78929 21.1128 8 21.5961 8 22.1C8 22.6039 7.78929 23.0872 7.41421 23.4435C7.03914 23.7998 6.53043 24 6 24C5.46957 24 4.96086 23.7998 4.58579 23.4435C4.21071 23.0872 4 22.6039 4 22.1C4 21.0455 4.89 20.2 6 20.2ZM15 13.55L17.78 8.8H5.14L7.5 13.55H15Z" fill="#646464"/>
</svg>
:""
            }
              {!isloggedin ? (
                <button className="button scale text-[#444444] font-semibold py-2 px-12 rounded-full border-[#444444] border">
                  Contact
                </button>
              ) : (
                <button className="button scale text-[#444444] font-semibold py-2 px-12 rounded-full border-[#444444] border">
                  <Link href={"/logout"}>Logout</Link>
                </button>
              )}
              {!isloggedin ? (
                <button className="button scale text-white bg-[#444444] font-semibold py-2 px-12 rounded-full border-[#444444] border">
                  <Link href={"/login"}>Login</Link>
                </button>
              ) : (
                <Image
                  className="scale"
                  src={data.user.image}
                  height={50}
                  width={50}
                />
              )}
            </div>
          </div>
        </div>
      </div>
    </nav>
  );
};

export default Navbar;
